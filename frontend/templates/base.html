<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriGuide{% block title %}{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <header>
        <div class="container">
            <a href="{{ url_for('home') }}" class="logo">NutriGuide</a>
            <nav>
                {% if session.get('logged_in') %}
                
                    <div class="header-search">
                        <form method="POST" action="{{ url_for('search_bar') }}" class="search-form">
                            {{ search_form.hidden_tag() }}
                            <div class="search-input">
                                {{ search_form.search_bar(size=20, placeholder="Search nutrients...", class="search-bar") }}
                                <button type="submit" class="search-btn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </form>
                    </div>

                    <div class="dropdown">
                        <button class="dropbtn nav-btn">
                            <i class="fas fa-vitamin"></i>
                            <span>Nutrients</span>
                            <i class="fa fa-caret-down"></i>
                        </button>
                        <div class="dropdown-content">
                            <div class="dropdown-column">
                                <a href="{{ url_for('nutrients') }}?nutrient=Copper">Copper</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Calcium">Calcium</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Choline">Choline</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Cholesterol">Cholesterol</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Fluoride">Fluoride</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=SaturatedFat">Saturated Fat</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=VitaminA">Vitamin A</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=VitaminC">Vitamin C</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=VitaminD">Vitamin D</a>
                            </div>
                            <div class="dropdown-column">
                                <a href="{{ url_for('nutrients') }}?nutrient=VitaminE">Vitamin E</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=VitaminK">Vitamin K</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=VitaminB1">Vitamin B1</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=VitaminB2">Vitamin B2</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=VitaminB3">Vitamin B3</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=VitaminB5">Vitamin B5</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=VitaminB6">Vitamin B6</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=VitaminB12">Vitamin B12</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Fiber">Fiber</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Folate">Folate</a>
                            </div>
                            <div class="dropdown-column">
                                <a href="{{ url_for('nutrients') }}?nutrient=FolicAcid">Folic Acid</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Iodine">Iodine</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Iron">Iron</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Magnesium">Magnesium</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Manganese">Manganese</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Phosphorus">Phosphorus</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Potassium">Potassium</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Selenium">Selenium</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Sodium">Sodium</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Sugar">Sugar</a>
                                <a href="{{ url_for('nutrients') }}?nutrient=Zinc">Zinc</a>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                {% if session.get('logged_in') %}          
                    <a href="{{ url_for('home') }}">Home</a>
                    <a href="{{ url_for('profile') }}">Profile</a>
                    <a href="{{ url_for('show_favorites') }}">Favorites</a>
                    <a href="{{ url_for('show_history') }}">History</a>
                    <a href="{{ url_for('logout') }}">Logout</a>
                {% else %}
                    <a href="{{ url_for('auth_page') }}">Login</a>
                {% endif %}
            </nav>
        </div>
    </header>

    <main class="container">
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <div class="flash-messages">
                    {% for message in messages %}
                        <div class="flash-message">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
        
        {% block content %}{% endblock %}
    </main>

    <footer>
        <div class="container">
            <p>© 2025 NutriGuide - Your Personal Nutrition Assistant</p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    {% block extra_js %}{% endblock %}

    <!-- Add this right before the closing </body> tag in base.html -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner">
                <div class="loading-dot dot-1"></div>
                <div class="loading-dot dot-2"></div>
                <div class="loading-dot dot-3"></div>
            </div>
            <p class="loading-text">Analyzing your symptoms...</p>
            <div class="loading-cute">
                <i class="fas fa-carrot"></i>
                <i class="fas fa-apple-alt"></i>
                <i class="fas fa-leaf"></i>
            </div>
        </div>
    </div>

    <style>
    .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(255, 255, 255, 0.9);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
    }

    .loading-screen.active {
        opacity: 1;
        pointer-events: all;
    }

    .loading-content {
        text-align: center;
        max-width: 300px;
    }

    .loading-spinner {
        display: flex;
        justify-content: center;
        margin-bottom: 20px;
    }

    .loading-dot {
        width: 15px;
        height: 15px;
        border-radius: 50%;
        background-color: #4CAF50;
        margin: 0 5px;
        animation: bounce 1.4s infinite ease-in-out;
    }

    .dot-1 {
        animation-delay: -0.32s;
    }

    .dot-2 {
        animation-delay: -0.16s;
    }

    @keyframes bounce {
        0%, 80%, 100% { transform: scale(0); }
        40% { transform: scale(1); }
    }

    .loading-text {
        font-size: 1.2rem;
        color: #333;
        margin-bottom: 20px;
        font-weight: 500;
    }

    .loading-cute i {
        font-size: 2rem;
        margin: 0 10px;
        color: #FF9800;
        animation: float 3s ease-in-out infinite;
    }

    .loading-cute i:nth-child(2) {
        animation-delay: 0.3s;
        color: #F44336;
    }

    .loading-cute i:nth-child(3) {
        animation-delay: 0.6s;
        color: #8BC34A;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-15px); }
    }
    </style>

        <!-- Background Decorations -->
    <div class="bg-decorations">
        <!-- Flower 1 (Top Left) -->
        <svg class="decoration" style="top: 10%; left: 5%; width: 120px; color: #fbcfe8; animation-delay: 0.5s;">
            <path d="M50 0C50 27.6142 72.3858 50 100 50C72.3858 50 50 72.3858 50 100C50 72.3858 27.6142 50 0 50C27.6142 50 50 27.6142 50 0Z"/>
        </svg>
        
        <!-- Flower 2 (Bottom Right) -->
        <svg class="decoration" style="bottom: 10%; right: 5%; width: 150px; color: #f9a8d4; animation-delay: 2s;">
            <path d="M50 0C50 27.6142 72.3858 50 100 50C72.3858 50 50 72.3858 50 100C50 72.3858 27.6142 50 0 50C27.6142 50 50 27.6142 50 0Z"/>
        </svg>
        
        <!-- Stars -->
        <div class="decoration pulse" style="top: 20%; right: 15%; font-size: 24px; color: #69c672;">★</div>
        <div class="decoration pulse" style="bottom: 25%; left: 20%; font-size: 18px; color: #8bc862; animation-delay: 1.5s;">★</div>
        
        <!-- Hearts -->
        <div class="decoration" style="top: 40%; left: 10%; font-size: 20px; color: #fca5a5;">♥</div>
        <div class="decoration" style="bottom: 30%; right: 10%; font-size: 16px; color: #fecaca; animation-delay: 3s;">♥</div>
        
        <!-- Sparkles (using Font Awesome) -->
        <i class="fas fa-sparkle decoration pulse" style="top: 15%; left: 20%; font-size: 18px; color: #a5b4fc;"></i>
        <i class="fas fa-sparkle decoration pulse" style="bottom: 20%; right: 20%; font-size: 22px; color: #c4b5fd; animation-delay: 1s;"></i>
    </div>

    <style>
        /* Background Decorations Styles */
        .bg-decorations {
            pointer-events: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1; /* Behind all content */
        }
        
        .decoration {
            position: absolute;
            opacity: 0.50;
            animation: float 8s ease-in-out infinite;
        }
        
        .decoration.pulse {
            animation: pulse 4s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(5deg); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.1; transform: scale(1); }
            50% { opacity: 0.3; transform: scale(1.1); }
        }
        
        /* Mobile adjustments */
        @media (max-width: 768px) {
            .decoration {
                opacity: 0.1;
                transform: scale(0.7);
            }
            .bg-decorations {
                display: none; /* Or keep a few simplified decorations */
            }
        }
    </style>
</body>
</html>